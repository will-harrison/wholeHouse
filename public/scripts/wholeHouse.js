// Generated by CoffeeScript 1.6.3
(function() {
  var io;

  io = require('./sockets.js');

  exports.countdown = function(milliseconds, update, complete) {
    var callback, frequency, start;
    if (complete == null) {
      complete = null;
    }
    start = new Date;
    frequency = 100;
    callback = function() {
      var now, timeLeft;
      now = new Date;
      timeLeft = new Date((milliseconds + 1000) - (now - start));
      update(timeLeft);
      if (now - start < milliseconds) {
        return setTimeout(callback, frequency);
      } else if (complete) {
        return complete();
      }
    };
    return setTimeout(callback, frequency);
  };

  exports.padLeft = function(length, string, padString) {
    var i, _i, _ref;
    string = string.toString();
    if (string.length < length) {
      for (i = _i = 1, _ref = length - string.length; 1 <= _ref ? _i <= _ref : _i >= _ref; i = 1 <= _ref ? ++_i : --_i) {
        string = padString + string;
      }
    }
    return string;
  };

  exports.randrange = function(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  };

  exports.countdownEmit = function(socket) {
    var callback, seconds;
    seconds = this.randrange(7, 14);
    callback = function() {
      if (seconds >= 0) {
        socket.emit('countdown', {
          time: seconds
        });
        seconds--;
        return setTimeout(callback, 1000);
      } else {
        return socket.emit('countdown', {
          time: "TIME'S UP!"
        });
      }
    };
    return setTimeout(callback, 1000);
  };

}).call(this);
